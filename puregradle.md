/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */

buildscript {

    //This file is used to configure your project with gradle


    group = 'com.optum.pure'
    version = '1.0.0'
    description = 'Java 21 Upgrade Project'

//    Java 21 Configuration
    java {
        toolchain {
            languageVersion = JavaLanguageVersion.of(21)
        }
    }

    repositories {
        maven {
            url 'https://repo1.uhc.com/artifactory/repoauth'
            credentials {
//                username = System.getenv("DOCKER_USERNAME")
//                password = System.getenv("DOCKER_PASSWORD")
                username = "runx_ohhlload";
                password = "ohLOA35U";
            }
        }
        mavenCentral()// // Use Maven Central for dependencies
    }
//  Manage dependency versions via BOMs
    DependencyManagement {
        imports {
            mavenBom 'com.amazonaws:aws-java-sdk-bom:1.12.734' // AWS SDK BOM
            mavenBom "org.springframework.boot:spring-boot-dependencies:3.2.5" // Spring BOM
        }
    }
}

plugins {
    id 'java'
    id 'eclipse'
    id 'idea'
    id 'org.springframework.boot' version '3.2.5' // Spring Boot updated
    id 'io.spring.dependency-management' version '1.1.4' // Compatible with SB 3.2.5
}
//plugins {
//    id 'org.springframework.boot' version '3.2.5' // Spring Boot 3.2.5 - Compatible with Java 21
//    id 'io.spring.dependency-management' version '1.1.4' // Manages dependency versions
//    id 'java' // Java plugin
//}

/// Method to get the current git branch
def gitBranch() {
    def branch = ""
    def proc = "git describe --all".execute()
    proc.in.eachLine { line -> branch = line }
    proc.err.eachLine { line -> println line }
    proc.waitFor()
    branch
}

print gitBranch()

if (gitBranch().equals("heads/master") || gitBranch().equals("remotes/origin/master")) {
    project.version = '2.0-SNAPSHOT'
} else {
    project.version = '1.0-SNAPSHOT'
}

//apply plugin: 'java'
//apply plugin: 'eclipse'
//apply plugin: 'idea'
//apply plugin: 'io.spring.dependency-management'


// TODO Java version configuration using Java 21 ===
java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(21) // Change this if you want to use a different Java version
    }
}

repositories {
    maven {
        url 'https://repo1.uhc.com/artifactory/repoauth'
        credentials {
//            username = System.getenv("DOCKER_USERNAME")
//            password = System.getenv("DOCKER_PASSWORD")
            username = "runx_ohhlload";
            password = "ohLOA35U";
        }
    }
    maven {
        url 'https://repo1.uhc.com/artifactory/libs-releases/'
    }
}



sourceCompatibility = 1.8
targetCompatibility = 1.8

dependencyManagement {
    imports {
        mavenBom 'com.amazonaws:aws-java-sdk-bom:1.12.734'
    }
}

dependencies {
    annotationProcessor "org.projectlombok:lombok:1.18.22"
    implementation 'com.amazonaws:aws-java-sdk-s3:1.12.734'
    implementation 'com.amazonaws:aws-java-sdk-s3' //AWS SDK S3

    // Logging - compatible with Java 21
    implementation 'org.apache.logging.log4j:log4j-api:2.22.0'
    implementation 'org.apache.logging.log4j:log4j-core:2.22.0'

//    implementation 'org.apache.logging.log4j:log4j-api:2.17.1'
//    implementation 'org.apache.logging.log4j:log4j-core:2.17.1'


    // https://mvnrepository.com/artifact/javax.json/javax.json-api

    // JSON processing
    implementation 'com.fasterxml.jackson.core:jackson-annotations'
    implementation 'com.fasterxml.jackson.core:jackson-core'
    implementation 'com.fasterxml.jackson.core:jackson-databind'
    implementation 'org.json:json:20231013'
    implementation 'com.google.code.gson:gson:2.9.1'
    //End New json
    implementation group: 'javax.json', name: 'javax.json-api', version: '1.0-b01'
    // https://mvnrepository.com/artifact/com.google.code.gson/gson
    implementation group: 'com.google.code.gson', name: 'gson',version: '2.9.1'
    implementation group: 'org.glassfish', name: 'javax.json', version: '1.1'
    // https://mvnrepository.com/artifact/org.elasticsearch.client/elasticsearch-rest-high-level-client
    implementation 'org.elasticsearch.client:elasticsearch-rest-high-level-client:7.17.15'
    //JMockit dependencies
    testImplementation group: 'org.jmockit', name: 'jmockit', version: '1.19'
    //JUnit dependencies
    testImplementation 'junit:junit:4.13.2'
    // https://mvnrepository.com/artifact/org.json/json
    implementation group: 'org.json', name: 'json', version: '20231013'

    // Lombok (Only used at compile-time)
    compileOnly 'org.projectlombok:lombok:1.18.30'
    annotationProcessor 'org.projectlombok:lombok:1.18.30'
    // https://mvnrepository.com/artifact/org.projectlombok/lombok
    implementation group: 'org.projectlombok', name: 'lombok', version: '1.18.22'

    // Spring Kafka (compatible with Spring Boot 3.2.5)
    implementation 'org.springframework.kafka:spring-kafka'

    // Elasticsearch client (Java 21 compatible)
    implementation 'org.elasticsearch.client:elasticsearch-rest-high-level-client:7.17.15'

    // Spring Web MVC & REST
    implementation 'org.springframework.boot:spring-boot-starter-web'

    // Spring Kafka (compatible with Spring Boot 3.2.5)
    implementation 'org.springframework.kafka:spring-kafka'

    // IO & YAML Support
    implementation 'commons-io:commons-io:2.15.1'
    implementation 'org.yaml:snakeyaml:2.0'

    // Unit Testing Dependencies
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
    testImplementation 'org.mockito:mockito-core:5.12.0'
    testImplementation 'org.junit.jupiter:junit-jupiter-api:5.10.2'
    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.10.2'


    // https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-annotations
    implementation group: 'com.fasterxml.jackson.core', name: 'jackson-annotations',version:'2.16.2'
    implementation group: 'com.fasterxml.jackson.core', name: 'jackson-core',version:'2.16.2'
    implementation group: 'com.fasterxml.jackson.core', name: 'jackson-databind',version:'2.16.2'
    // https://mvnrepository.com/artifact/org.powermock/powermock-api-mockito
    testImplementation group: 'org.powermock', name: 'powermock-api-mockito', version: '1.6.5'
    // https://mvnrepository.com/artifact/org.powermock/powermock-module-junit4
    testImplementation group: 'org.powermock', name: 'powermock-module-junit4', version: '1.6.5'
    // https://mvnrepository.com/artifact/org.mockito/mockito-core
    testImplementation group: 'org.mockito', name: 'mockito-core', version: '1.10.19'
    // https://mvnrepository.com/artifact/commons-io/commons-io
    implementation group: 'commons-io', name: 'commons-io', version: '2.8'
    implementation group: 'org.yaml', name:'snakeyaml', version:'2.0'
    // https://mvnrepository.com/artifact/javax.ws.rs/javax.ws.rs-api
    implementation group: 'javax.ws.rs', name: 'javax.ws.rs-api',version: '2.1'

    // Configure test platform for JUnit 5
    test {
        useJUnitPlatform()
    }
}
